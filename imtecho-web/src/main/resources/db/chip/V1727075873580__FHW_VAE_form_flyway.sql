with insert_into_medplat_form_master as (
	INSERT INTO medplat_form_master
	("uuid", form_name, form_code, current_version, state, created_by, created_on, modified_by, modified_on, menu_config_id)
	SELECT 
		'be161315-3942-4611-b35d-142013dd89c1',
		'FHW_VAE',
		'FHW_VAE',
		'1',
		'ACTIVE',
		97104,
		now(),
		97104,
		now(),
		393
	ON CONFLICT (form_code)
	DO UPDATE 
	SET
		uuid=EXCLUDED."uuid",
		form_name=EXCLUDED.form_name,
		current_version=cast(cast(coalesce((select max(cast(medplat_form_version_history.version as integer)) from medplat_form_master inner join medplat_form_version_history on medplat_form_master.uuid  = medplat_form_version_history.form_master_uuid where medplat_form_master.form_code = EXCLUDED.form_code and medplat_form_version_history.version <> 'DRAFT'),'0') as integer) + 1 as text),
		state=EXCLUDED.state,
		created_by=EXCLUDED.created_by, 
		created_on=EXCLUDED.created_on, 
		modified_by=EXCLUDED.modified_by, 
		modified_on=EXCLUDED.modified_on, 
		menu_config_id=EXCLUDED.menu_config_id
	returning medplat_form_master.current_version
)
INSERT INTO medplat_form_version_history
("uuid", form_master_uuid, template_config, field_config, "version", created_by, created_on, modified_by, modified_on, form_object, template_css, form_vm, execution_sequence, query_config)
SELECT
	'786b0bf8-35ee-e893-d34f-4fd0948efd6f',
	'be161315-3942-4611-b35d-142013dd89c1',
	'[{"type":"CARD","config":{"title":"Basic Details","size":"12","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null,"isCollapsible":false},"elements":[{"type":"ROW","config":{"size":"12","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null},"elements":[{"type":"COL","config":{"size":"6","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null},"elements":[{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"unique_health_id","fieldName":"Member ID","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"age","fieldName":"Age","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"gender","fieldName":"Gender","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"marital_status","fieldName":"Marital Status","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"last_method_of_contraception","fieldName":"Last Method of Contraception Used","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"family_phone_no","fieldName":"Family phone number","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"family_address","fieldName":"Family address","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"birth_cert_number","fieldName":"Birth certificate number","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"birth_weight","fieldName":"Birth weight","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"weight","fieldName":"Latest weight","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}}]},{"type":"COL","config":{"size":"6","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null},"elements":[{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"member_name","fieldName":"Member name","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"dob","fieldName":"DOB","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"nrc_number","fieldName":"NRC Number","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"religion","fieldName":"Religion","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"lmp_date","fieldName":"LMP (Last Menstrual Period) date","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"hiv_status","fieldName":"HIV Status","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"chronic_disease","fieldName":"Chronic diseases","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"developmental_delays","fieldName":"Developmental delays","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"immunisation_status","fieldName":"Immunization status","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}}]}]}]},{"type":"CARD","config":{"title":"VAE Details","size":"12","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null,"isCollapsible":false},"elements":[{"type":"ROW","config":{"size":"12","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null},"elements":[{"type":"COL","config":{"size":"6","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null},"elements":[{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"service_date","fieldName":"Service date","fieldType":"DATE","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"vaccine_name","fieldName":"Name of Vaccine","fieldType":"DROPDOWN","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"batch_number","fieldName":"Batch number","fieldType":"SHORT_TEXT","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}}]},{"type":"COL","config":{"size":"6","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null},"elements":[{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"adverse_effect","fieldName":"Adverse effect from immunization","fieldType":"DROPDOWN","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"expiry_date","fieldName":"Expiry date","fieldType":"DATE","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"manufacturer","fieldName":"Manufacturer of vaccine","fieldType":"SHORT_TEXT","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}}]}]}]}]',
	'{"FHW_VAE":{"Age":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"age","hasError":false,"showCard":true,"fieldName":"Age","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Age","errorMsgListKeys":[]},"DOB":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"dob","hasError":false,"showCard":true,"fieldName":"DOB","fieldType":"INFORMATION_DISPLAY","dateFormat":"dd/MM/yyyy","disability":"null","requirable":"null","visibility":"null","displayType":"date","showContent":false,"displayValue":"Date of Birth","errorMsgListKeys":[]},"Gender":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"gender","hasError":false,"showCard":true,"fieldName":"Gender","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Gender","errorMsgListKeys":[]},"Religion":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"religion","hasError":false,"showCard":true,"fieldName":"Religion","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Religion","errorMsgListKeys":[]},"Member ID":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"unique_health_id","hasError":false,"showCard":true,"fieldName":"Member ID","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Member ID","errorMsgListKeys":[]},"HIV Status":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"hiv_status","hasError":false,"showCard":true,"fieldName":"HIV Status","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"HIV Status","errorMsgListKeys":[]},"NRC Number":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"nrc_number","hasError":false,"showCard":true,"fieldName":"NRC Number","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"NRC Number","errorMsgListKeys":[]},"Expiry date":{"label":"Expiry date","events":"null","ngModel":"$formData$.memberVAEData","tooltip":"Expiry date","fieldKey":"expiry_date","isHidden":"false","fieldName":"Expiry date","fieldType":"DATE","disability":"null","isDisabled":"false","isRequired":"true","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"OR\",\"options\":[{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''MILD''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null},{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''SERIOUS''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null}]}}","placeholder":"Expiry date","maxDateField":"{\"key\":\"$today$\",\"type\":\"VARIABLE\"}","minDateField":"{\"key\":\"$utilityData$.minExpiryDate\",\"type\":\"VARIABLE\"}","requiredMessage":"Please select expiry date"},"Member name":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"member_name","hasError":false,"showCard":true,"fieldName":"Member name","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Member Name","errorMsgListKeys":[]},"Batch number":{"label":"Batch number","events":"null","ngModel":"$formData$.memberVAEData","tooltip":"Batch number","fieldKey":"batch_number","hasError":false,"isHidden":"false","showCard":true,"fieldName":"Batch number","fieldType":"SHORT_TEXT","maxLength":"50","minLength":"1","disability":"null","hasPattern":"false","isDisabled":"false","isRequired":"true","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"OR\",\"options\":[{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''MILD''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null},{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''SERIOUS''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null}]}}","placeholder":"Batch number","showContent":false,"requiredMessage":"Please enter batch number","errorMsgListKeys":[]},"Birth weight":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"birth_weight","fieldName":"Birth weight","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"5\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"text","displayValue":"Birth weight (in Kgs)"},"Service date":{"label":"Service date","events":"null","ngModel":"$formData$.memberVAEData","tooltip":"Service date","fieldKey":"service_date","isHidden":"false","fieldName":"Service date","fieldType":"DATE","disability":"null","isDisabled":"true","isRequired":"false","requirable":"null","visibility":"null","placeholder":"Service date","maxDateField":"{\"key\":\"$today$\",\"type\":\"VARIABLE\"}","minDateField":"{\"key\":\"$utilityData$.minServiceDate\",\"type\":\"VARIABLE\"}","requiredMessage":"Please enter service date"},"Latest weight":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"weight","fieldName":"Latest weight","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"5\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"text","displayValue":"Latest weight (in Kgs)"},"Family address":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"family_address","hasError":false,"showCard":true,"fieldName":"Family address","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Family address","errorMsgListKeys":[]},"Marital Status":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"marital_status","hasError":false,"showCard":true,"fieldName":"Marital Status","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Marital Status","errorMsgListKeys":[]},"Name of Vaccine":{"label":"Name of Vaccine","events":"null","ngModel":"$formData$.memberVAEData","tooltip":"Name of Vaccine","fieldKey":"vaccine_name","hasError":false,"isHidden":"false","showCard":true,"fieldName":"Name of Vaccine","fieldType":"DROPDOWN","disability":"null","isDisabled":"false","isMultiple":"false","isRequired":"true","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"OR\",\"options\":[{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''MILD''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null},{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''SERIOUS''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null}]}}","optionsType":"variableList","placeholder":"-- SELECT --","showContent":false,"variableList":"$utilityData$.immunisationGiven","requiredMessage":"Please select Name of Vaccine","errorMsgListKeys":[],"additionalStaticOptionsRequired":"false"},"Chronic diseases":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"chronic_disease","hasError":false,"showCard":true,"fieldName":"Chronic diseases","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Chronic diseases","errorMsgListKeys":[]},"Family phone number":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"family_phone_no","hasError":false,"showCard":true,"fieldName":"Family phone number","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Family phone number","errorMsgListKeys":[]},"Immunization status":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"immunisation_status","fieldName":"Immunization status","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"5\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"text","displayValue":"Immunisation status"},"Developmental delays":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"developmental_delays","hasError":false,"showCard":true,"fieldName":"Developmental delays","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"5\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"text","showContent":false,"displayValue":"Developmental delays","errorMsgListKeys":[]},"Manufacturer of vaccine":{"label":"Manufacturer","events":"null","ngModel":"$formData$.memberVAEData","tooltip":"Manufacturer of vaccine","fieldKey":"manufacturer","hasError":false,"isHidden":"false","showCard":true,"fieldName":"Manufacturer of vaccine","fieldType":"SHORT_TEXT","maxLength":"50","minLength":"1","disability":"null","hasPattern":"false","isDisabled":"false","isRequired":"true","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"OR\",\"options\":[{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''MILD''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null},{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''SERIOUS''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null}]}}","placeholder":"Manufacturer of vaccine","showContent":false,"requiredMessage":"Please enter manufacturer of vaccine","errorMsgListKeys":[]},"Birth certificate number":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"birth_cert_number","hasError":false,"showCard":true,"fieldName":"Birth certificate number","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"5\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"text","showContent":false,"displayValue":"Birth certificate number","errorMsgListKeys":[]},"Adverse effect from immunization":{"label":"Adverse effect from immunization","events":"null","ngModel":"$formData$.memberVAEData","tooltip":"Adverse effect from immunization","fieldKey":"adverse_effect","hasError":false,"isHidden":"false","showCard":true,"fieldName":"Adverse effect from immunization","fieldType":"DROPDOWN","disability":"null","isDisabled":"false","isMultiple":"false","isRequired":"true","requirable":"null","visibility":"null","optionsType":"staticOptions","placeholder":"-- SELECT --","showContent":false,"staticOptions":"[{\"key\":\"NO\",\"value\":\"No Adverse Effect\"},{\"key\":\"MILD\",\"value\":\"Mild Adverse Effect\"},{\"key\":\"SERIOUS\",\"value\":\"Serious Adverse Effect\"}]","requiredMessage":"Please select adverse effect from immunization","errorMsgListKeys":[],"additionalStaticOptionsRequired":"false"},"LMP (Last Menstrual Period) date":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"lmp_date","hasError":false,"showCard":true,"fieldName":"LMP (Last Menstrual Period) date","fieldType":"INFORMATION_DISPLAY","dateFormat":"dd/MM/yyyy","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''Female''\",\"value2\":null,\"fieldName\":\"$infoData$.memberData.gender\",\"queryCode\":null,\"expression\":null},{\"type\":\"VARIABLE\",\"operator\":\"GTE\",\"value1\":\"9\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null},{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"110\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"date","showContent":false,"displayValue":"LMP date","errorMsgListKeys":[]},"Last Method of Contraception Used":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"last_method_of_contraception","hasError":false,"showCard":true,"fieldName":"Last Method of Contraception Used","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"VARIABLE\",\"operator\":\"GTE\",\"value1\":\"9\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null},{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"110\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"text","showContent":false,"displayValue":"Last Method of Contraception Used","errorMsgListKeys":[]}}}',
	current_version,
	97104,
	now(),
	97104,
	now(),
	'[{"title":"$formData$","isArray":false,"nodes":[{"title":"memberVAEData","nodes":[],"indexAlias":null,"$$hashKey":"object:320","path":"$formData$.memberVAEData","backendConfigPath":"$formData$.memberVAEData"}],"path":"$formData$","backendConfigPath":"$formData$","$$hashKey":"object:291"},{"title":"$infoData$","isArray":false,"nodes":[{"title":"memberData","nodes":[],"indexAlias":null,"$$hashKey":"object:307","path":"$infoData$.memberData","backendConfigPath":"$infoData$.memberData"}],"path":"$infoData$","backendConfigPath":"$infoData$","$$hashKey":"object:292"}]',
	'label {
    white-space: normal !important;
    line-height: 1.2 !important;
}',
	'{"formVariables":[{"value":"ageInYears","type":"NUMBER","bindTo":"$utilityData$","setter":true,"setterMethodName":"setAgeInYears","setterMethodCode":"(function setAgeInYears() {\n\n    let ageParts = $infoData$.memberData.age.split('' '');\n    let years = 0;\n    if (ageParts.length < 6) {\n        years = 0\n    }\n    else {\n        years = isNaN(parseInt(ageParts[0])) ? 0 : parseInt(ageParts[0]);\n    }\n    $utilityData$.ageInYears = years;\n\t\n});"},{"value":"minServiceDate","type":"DATE","bindTo":"$utilityData$","setter":true,"setterMethodName":"setMinServiceDate","setterMethodCode":"(function setMinServiceDate() {\n    $utilityData$.minServiceDate = $formData$.memberVAEData.service_date ? moment($formData$.memberVAEData.service_date) : moment().subtract(9, ''months'');\n});"},{"value":"immunisationGiven","type":"ARRAY","bindTo":"$utilityData$","setter":true,"setterMethodName":"setImmunisationGiven","setterMethodCode":"(function setImmunisationGiven() {\n\tlet all_imm_given = $infoData$.memberData.immunisation_given.split('','');\n    let immunisations = [];\n    \n    for (let imm of all_imm_given) {\n        immunisations.push({key: imm.split(''#'')[0], value: imm.split(''#'')[0]});\n    }\n    console.log(immunisations)\n    $utilityData$.immunisationGiven = immunisations\n});"},{"value":"minExpiryDate","type":"DATE","bindTo":"$utilityData$","setter":true,"setterMethodName":"setMinExpiryDate","setterMethodCode":"(function setMinExpiryDate() {\n\t$utilityData$.minExpiryDate = $infoData$.memberData.dob;\n\t\n});"},{"value":"isChildImmunisedInOneYear","type":"BOOLEAN","bindTo":"$utilityData$","setter":true,"setterMethodName":"setIsChildImmunisedInOneYear","setterMethodCode":"(function setIsChildImmunisedInOneYear() {\n    const memberDetails = $infoData$.memberData\n        if (memberDetails.immunisation_given != null && memberDetails.immunisation_given.length > 0) {\n            const immunisationGiven = memberDetails.immunisation_given.split(\",\")\n            const immunisationList = []\n\n            for (let immunisation of immunisationGiven) {\n                immunisationList.push(immunisation.split(\"#\")[0])\n            }\n\n\n            if (immunisationList.length) {\n                if (\n                    immunisationList.includes(\"BCG\")\n                    && immunisationList.includes(\"OPV_1\")\n                    && immunisationList.includes(\"OPV_2\")\n                    && immunisationList.includes(\"OPV_3\")\n                    && (immunisationList.includes(\"PENTA_1\") || immunisationList.includes(\"DPT_1\"))\n                    && (immunisationList.includes(\"PENTA_2\") || immunisationList.includes(\"DPT_2\"))\n                    && (immunisationList.includes(\"PENTA_3\") || immunisationList.includes(\"DPT_3\"))\n                    && (immunisationList.includes(\"MEASLES_RUBELLA_1\") || immunisationList.includes(\"MEASLES_1\"))) {\n                    $utilityData$.isChildImmunisedInOneYear = true;\n                } else {\n                    $utilityData$.isChildImmunisedInOneYear = false;\n                }\n            } else {\n                $utilityData$.isChildImmunisedInOneYear = false;\n            }\n        } else {\n            $utilityData$.isChildImmunisedInOneYear = false;\n        }\n});"},{"value":"isChildImmunisedInTwoYear","type":"BOOLEAN","bindTo":"$utilityData$","setter":true,"setterMethodName":"setIsChildImmunisedInTwoYear","setterMethodCode":"(function setIsChildImmunisedInTwoYear() {\n    const memberDetails = $infoData$.memberData\n        if (memberDetails.immunisation_given != null && memberDetails.immunisation_given.length > 0) {\n            const immunisationGiven = memberDetails.immunisation_given.split(\",\")\n            const immunisationList = []\n\n            for (let immunisation of immunisationGiven) {\n                immunisationList.push(immunisation.split(\"#\")[0])\n            }\n\n            if (immunisationList.length) {\n                if (\n                    immunisationList.includes(\"BCG\")\n                    && immunisationList.includes(\"VITTAMIN_A_50000\")\n                    && immunisationList.includes(\"VITTAMIN_A_100000\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_1\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_2\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_3\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_4\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_5\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_6\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_7\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_8\")\n                    && immunisationList.includes(\"OPV_0\")\n                    && immunisationList.includes(\"OPV_1\")\n                    && immunisationList.includes(\"OPV_2\")\n                    && immunisationList.includes(\"OPV_3\")\n                    && immunisationList.includes(\"PCV_1\")\n                    && immunisationList.includes(\"PCV_2\")\n                    && immunisationList.includes(\"PCV_3\")\n                    && immunisationList.includes(\"DPT_HEB_HIB_1\")\n                    && immunisationList.includes(\"DPT_HEB_HIB_2\")\n                    && immunisationList.includes(\"DPT_HEB_HIB_3\")\n                    && immunisationList.includes(\"ROTA_VACCINE_1\")\n                    && immunisationList.includes(\"MEASLES_RUBELLA_1\")\n                    && immunisationList.includes(\"MEASLES_RUBELLA_2\")) {\n                    $utilityData$.isChildImmunisedInTwoYear = true;\n                } else {\n                    $utilityData$.isChildImmunisedInTwoYear = false;\n                }\n            } else {\n                $utilityData$.isChildImmunisedInTwoYear = false;\n            }\n        } else {\n            $utilityData$.isChildImmunisedInTwoYear = false;\n        }\n});"}],"formMethods":[{"value":"setImmunisationStatus","code":"(function setImmunisationStatus() {\n\tconst dobDate = new Date($infoData$.memberData.dob);\n    const currentDate = new Date();\n    \n    let age = currentDate.getFullYear() - dobDate.getFullYear();\n    const monthDiff = currentDate.getMonth() - dobDate.getMonth();\n    const dayDiff = currentDate.getDate() - dobDate.getDate();\n    \n    if (monthDiff < 0 || (monthDiff === 0 && dayDiff < 0)) {\n        age--;\n    }\n\n    if (age < 1) {\n        $infoData$.memberData.immunisation_status = ''Not fully immunised''\n    } else if (age >= 1 && age <= 2) {\n        $infoData$.memberData.immunisation_status = $utilityData$.isChildImmunisedInOneYear ? ''Fully immunised'' : ''Not fully immunised''\n    } else {\n        $infoData$.memberData.immunisation_status = $utilityData$.isChildImmunisedInTwoYear ? ''Fully immunised'' : ''Not fully immunised''\n    }\n});"}],"formQueries":[{"value":"Get Child Details","queryCode":"get_child_details","params":"member_id","paramConfig":"{\"member_id\":\"$formData$.memberVAEData.member_id\"}","query":"with\n    hof_det as (\n        select\n            im.mobile_number\n        from\n            imt_member im\n            where im.family_id = (select family_id from imt_member where id = #member_id#)\n            and im.family_head\n    )\nselect\n    im.unique_health_id,\n    concat_ws ('' '', im.first_name, im.middle_name, im.last_name) as member_name,\n    cast(age (im.dob) as text) as age,\n    im.dob,\n    case\n        when im.gender = ''F'' then ''Female''\n        else ''Male''\n    end as gender,\n    im.immunisation_given,\n    im.nrc_number,\n    im.weight,\n    im.birth_weight,\n    im.birth_cert_number,\n    (\n        select\n            value\n        from\n            listvalue_field_value_detail\n        where\n            id = im.marital_status\n    ) as marital_status,\n    (\n        select\n            value\n        from\n            listvalue_field_value_detail\n        where\n            cast(id as text) = case\n                when imf.religion is not null then imf.religion\n                when im.member_religion is not null then im.member_religion\n                else null\n            end\n    ) as religion,\n    case\n        when im.last_method_of_contraception = ''NATURAL_METHODS'' then ''Natural methods''\n        when im.last_method_of_contraception = ''ORALPILLS''\n        or im.last_method_of_contraception = ''ORAL_PILLS'' then ''Oral pills''\n        when im.last_method_of_contraception = ''IUCD5'' then ''IUCD 5 years''\n        when im.last_method_of_contraception = ''IUCD10'' then ''IUCD 10 years''\n        when im.last_method_of_contraception = ''STERILIZATION'' then ''Sterilization''\n        when im.last_method_of_contraception = ''CONDOM'' then ''Condom''\n        when im.last_method_of_contraception = ''MLSTR'' then ''Male sterilization''\n        when im.last_method_of_contraception = ''CONTRA'' then ''Emergency Contraceptive Pills''\n        when im.last_method_of_contraception = ''INJECTABLES'' then ''Injectables''\n        when im.last_method_of_contraception = ''BARRIER_METHOD'' then ''Barrier Method''\n        when im.last_method_of_contraception = ''CHHAYA'' then ''Chhaya''\n        when im.last_method_of_contraception = ''ANTARA'' then ''Antara''\n        else im.last_method_of_contraception\n    end as last_method_of_contraception,\n    im.lmp as lmp_date,\n    cast(im.additional_info as json)->> ''hivTest'' as hiv_status,\n    (\n        select\n            string_agg (value, '', '')\n        from\n            listvalue_field_value_detail lfvd\n        where\n            cast(id as text) in (\n                select\n                    unnest (string_to_array (im.chronic_disease, '',''))\n            )\n    ) as chronic_disease,\n    cast(im.additional_info as json)->> ''developmentalDelays'' as developmental_delay,\n    (\n        select\n            mobile_number\n        from\n            hof_det\n    ) as family_phone_no,\n    concat_ws ('' '', imf.house_number, imf.address1, imf.address2) as family_address\nfrom\n    imt_member im\n    inner join imt_family imf on imf.family_id = im.family_id\nwhere\n    im.id = #member_id#;","response":"$infoData$.memberData","isResultArray":null,"successMessage":null,"failureMessage":"Member not found.","isResponseMandatory":true,"isField":null,"isPagination":false},{"value":"Get Child VAE Data","queryCode":"get_child_vae_data","params":"member_vae_id","paramConfig":"{\"member_vae_id\":\"$stateParams$.id\"}","query":"select \n    id,\n    member_id,\n    adverse_effect,\n\tvaccine_name,\n\texpiry_date,\n\tbatch_number,\n\tmanufacturer\nfrom rch_vaccine_adverse_effect\nwhere id = #member_vae_id#\norder by modified_on desc limit 1;","response":"$formData$.memberVAEData","isResultArray":null,"successMessage":null,"failureMessage":"Screening records not found.","isResponseMandatory":true,"isField":null,"isPagination":false}]}',
	'[{"type":"FORM_QUERY","value":"Get Child VAE Data","continueIfFail":false},{"type":"FORM_QUERY","value":"Get Child Details","continueIfFail":false},{"type":"FORM_VARIABLE_SETTER","value":"isChildImmunisedInOneYear","continueIfFail":true},{"type":"FORM_VARIABLE_SETTER","value":"isChildImmunisedInTwoYear","continueIfFail":true},{"type":"FORM_METHOD","value":"setImmunisationStatus","continueIfFail":true},{"type":"FORM_VARIABLE_SETTER","value":"ageInYears","continueIfFail":true},{"type":"FORM_VARIABLE_SETTER","value":"minServiceDate","continueIfFail":true},{"type":"FORM_VARIABLE_SETTER","value":"immunisationGiven","continueIfFail":true},{"type":"FORM_VARIABLE_SETTER","value":"minExpiryDate","continueIfFail":true}]',
	'[{"queryCode":"update_vae_det","hasLoop":null,"queryPath":"$formData$.memberVAEData","subQueries":[],"params":[{"key":"adverse_effect","type":"FIELD","valueKey":"adverse_effect"},{"key":"vaccine_name","type":"FIELD","valueKey":"vaccine_name"},{"key":"batch_number","type":"FIELD","valueKey":"batch_number"},{"key":"expiry_date","type":"FIELD","valueKey":"expiry_date"},{"key":"manufacturer","type":"FIELD","valueKey":"manufacturer"},{"key":"vae_details_id","type":"META_DATA","valueKey":"$formData$.memberVAEData.id"}],"isEventResource":null,"$$hashKey":"object:14609","queryName":"Update VAE Details","query":"with update_or_delete as (\n    update rch_vaccine_adverse_effect\n    set\n        modified_by = #loggedInUserId#,\n        modified_on = now(),\n        adverse_effect = #adverse_effect#,\n        vaccine_name = #vaccine_name#,\n        batch_number = #batch_number#,\n        expiry_date = #expiry_date#,\n        manufacturer = #manufacturer#\n    where\n        id = #vae_details_id#\n        and #adverse_effect# <> ''NO''\n    returning id\n),\ndeleted as (\n    delete from rch_vaccine_adverse_effect\n    where id = #vae_details_id#\n    and #adverse_effect# = ''NO''\n    returning id\n)\n\nselect id from update_or_delete\nunion all\nselect id from deleted;\n"}]'
FROM insert_into_medplat_form_master;


INSERT INTO medplat_form_version_history
("uuid", form_master_uuid, template_config, field_config, "version", created_by, created_on, modified_by, modified_on, form_object, template_css, form_vm, execution_sequence, query_config)
SELECT
	'cf2f5602-3085-24b0-324e-a52765b866e1',
	'be161315-3942-4611-b35d-142013dd89c1',
	'[{"type":"CARD","config":{"title":"Basic Details","size":"12","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null,"isCollapsible":false},"elements":[{"type":"ROW","config":{"size":"12","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null},"elements":[{"type":"COL","config":{"size":"6","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null},"elements":[{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"unique_health_id","fieldName":"Member ID","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"age","fieldName":"Age","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"gender","fieldName":"Gender","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"marital_status","fieldName":"Marital Status","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"last_method_of_contraception","fieldName":"Last Method of Contraception Used","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"family_phone_no","fieldName":"Family phone number","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"family_address","fieldName":"Family address","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"birth_cert_number","fieldName":"Birth certificate number","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"birth_weight","fieldName":"Birth weight","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"weight","fieldName":"Latest weight","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}}]},{"type":"COL","config":{"size":"6","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null},"elements":[{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"member_name","fieldName":"Member name","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"dob","fieldName":"DOB","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"nrc_number","fieldName":"NRC Number","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"religion","fieldName":"Religion","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"lmp_date","fieldName":"LMP (Last Menstrual Period) date","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"hiv_status","fieldName":"HIV Status","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"chronic_disease","fieldName":"Chronic diseases","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"developmental_delays","fieldName":"Developmental delays","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"immunisation_status","fieldName":"Immunization status","fieldType":"INFORMATION_DISPLAY","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}}]}]}]},{"type":"CARD","config":{"title":"VAE Details","size":"12","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null,"isCollapsible":false},"elements":[{"type":"ROW","config":{"size":"12","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null},"elements":[{"type":"COL","config":{"size":"6","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null},"elements":[{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"service_date","fieldName":"Service date","fieldType":"DATE","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"vaccine_name","fieldName":"Name of Vaccine","fieldType":"DROPDOWN","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"batch_number","fieldName":"Batch number","fieldType":"SHORT_TEXT","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}}]},{"type":"COL","config":{"size":"6","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null},"elements":[{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"adverse_effect","fieldName":"Adverse effect from immunization","fieldType":"DROPDOWN","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"expiry_date","fieldName":"Expiry date","fieldType":"DATE","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}},{"type":"TECHO_FORM_FIELD","elements":[],"isAdded":false,"config":{"fieldKey":"manufacturer","fieldName":"Manufacturer of vaccine","fieldType":"SHORT_TEXT","cssStyles":null,"cssClasses":null,"isRepeatable":false,"showAddRemoveButton":false,"ngModel":null,"isConditional":false,"ngIf":null}}]}]}]}]',
	'{"FHW_VAE":{"Age":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"age","hasError":false,"showCard":true,"fieldName":"Age","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Age","errorMsgListKeys":[]},"DOB":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"dob","hasError":false,"showCard":true,"fieldName":"DOB","fieldType":"INFORMATION_DISPLAY","dateFormat":"dd/MM/yyyy","disability":"null","requirable":"null","visibility":"null","displayType":"date","showContent":false,"displayValue":"Date of Birth","errorMsgListKeys":[]},"Gender":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"gender","hasError":false,"showCard":true,"fieldName":"Gender","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Gender","errorMsgListKeys":[]},"Religion":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"religion","hasError":false,"showCard":true,"fieldName":"Religion","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Religion","errorMsgListKeys":[]},"Member ID":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"unique_health_id","hasError":false,"showCard":true,"fieldName":"Member ID","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Member ID","errorMsgListKeys":[]},"HIV Status":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"hiv_status","hasError":false,"showCard":true,"fieldName":"HIV Status","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"HIV Status","errorMsgListKeys":[]},"NRC Number":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"nrc_number","hasError":false,"showCard":true,"fieldName":"NRC Number","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"NRC Number","errorMsgListKeys":[]},"Expiry date":{"label":"Expiry date","events":"null","ngModel":"$formData$.memberVAEData","tooltip":"Expiry date","fieldKey":"expiry_date","isHidden":"false","fieldName":"Expiry date","fieldType":"DATE","disability":"null","isDisabled":"false","isRequired":"true","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"OR\",\"options\":[{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''MILD''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null},{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''SERIOUS''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null}]}}","placeholder":"Expiry date","maxDateField":"{\"key\":\"$today$\",\"type\":\"VARIABLE\"}","minDateField":"{\"key\":\"$utilityData$.minExpiryDate\",\"type\":\"VARIABLE\"}","requiredMessage":"Please select expiry date"},"Member name":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"member_name","hasError":false,"showCard":true,"fieldName":"Member name","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Member Name","errorMsgListKeys":[]},"Batch number":{"label":"Batch number","events":"null","ngModel":"$formData$.memberVAEData","tooltip":"Batch number","fieldKey":"batch_number","hasError":false,"isHidden":"false","showCard":true,"fieldName":"Batch number","fieldType":"SHORT_TEXT","maxLength":"50","minLength":"1","disability":"null","hasPattern":"false","isDisabled":"false","isRequired":"true","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"OR\",\"options\":[{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''MILD''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null},{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''SERIOUS''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null}]}}","placeholder":"Batch number","showContent":false,"requiredMessage":"Please enter batch number","errorMsgListKeys":[]},"Birth weight":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"birth_weight","fieldName":"Birth weight","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"5\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"text","displayValue":"Birth weight (in Kgs)"},"Service date":{"label":"Service date","events":"null","ngModel":"$formData$.memberVAEData","tooltip":"Service date","fieldKey":"service_date","isHidden":"false","fieldName":"Service date","fieldType":"DATE","disability":"null","isDisabled":"true","isRequired":"false","requirable":"null","visibility":"null","placeholder":"Service date","maxDateField":"{\"key\":\"$today$\",\"type\":\"VARIABLE\"}","minDateField":"{\"key\":\"$utilityData$.minServiceDate\",\"type\":\"VARIABLE\"}","requiredMessage":"Please enter service date"},"Latest weight":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"weight","fieldName":"Latest weight","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"5\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"text","displayValue":"Latest weight (in Kgs)"},"Family address":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"family_address","hasError":false,"showCard":true,"fieldName":"Family address","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Family address","errorMsgListKeys":[]},"Marital Status":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"marital_status","hasError":false,"showCard":true,"fieldName":"Marital Status","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Marital Status","errorMsgListKeys":[]},"Name of Vaccine":{"label":"Name of Vaccine","events":"null","ngModel":"$formData$.memberVAEData","tooltip":"Name of Vaccine","fieldKey":"vaccine_name","hasError":false,"isHidden":"false","showCard":true,"fieldName":"Name of Vaccine","fieldType":"DROPDOWN","disability":"null","isDisabled":"false","isMultiple":"false","isRequired":"true","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"OR\",\"options\":[{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''MILD''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null},{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''SERIOUS''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null}]}}","optionsType":"variableList","placeholder":"-- SELECT --","showContent":false,"variableList":"$utilityData$.immunisationGiven","requiredMessage":"Please select Name of Vaccine","errorMsgListKeys":[],"additionalStaticOptionsRequired":"false"},"Chronic diseases":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"chronic_disease","hasError":false,"showCard":true,"fieldName":"Chronic diseases","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Chronic diseases","errorMsgListKeys":[]},"Family phone number":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"family_phone_no","hasError":false,"showCard":true,"fieldName":"Family phone number","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"null","displayType":"text","showContent":false,"displayValue":"Family phone number","errorMsgListKeys":[]},"Immunization status":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"immunisation_status","fieldName":"Immunization status","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"5\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"text","displayValue":"Immunisation status"},"Developmental delays":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"developmental_delays","hasError":false,"showCard":true,"fieldName":"Developmental delays","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"5\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"text","showContent":false,"displayValue":"Developmental delays","errorMsgListKeys":[]},"Manufacturer of vaccine":{"label":"Manufacturer","events":"null","ngModel":"$formData$.memberVAEData","tooltip":"Manufacturer of vaccine","fieldKey":"manufacturer","hasError":false,"isHidden":"false","showCard":true,"fieldName":"Manufacturer of vaccine","fieldType":"SHORT_TEXT","maxLength":"50","minLength":"1","disability":"null","hasPattern":"false","isDisabled":"false","isRequired":"true","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"OR\",\"options\":[{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''MILD''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null},{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''SERIOUS''\",\"value2\":null,\"fieldName\":\"$formData$.memberVAEData.adverse_effect\",\"queryCode\":null,\"expression\":null}]}}","placeholder":"Manufacturer of vaccine","showContent":false,"requiredMessage":"Please enter manufacturer of vaccine","errorMsgListKeys":[]},"Birth certificate number":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"birth_cert_number","hasError":false,"showCard":true,"fieldName":"Birth certificate number","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"5\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"text","showContent":false,"displayValue":"Birth certificate number","errorMsgListKeys":[]},"Adverse effect from immunization":{"label":"Adverse effect from immunization","events":"null","ngModel":"$formData$.memberVAEData","tooltip":"Adverse effect from immunization","fieldKey":"adverse_effect","hasError":false,"isHidden":"false","showCard":true,"fieldName":"Adverse effect from immunization","fieldType":"DROPDOWN","disability":"null","isDisabled":"false","isMultiple":"false","isRequired":"true","requirable":"null","visibility":"null","optionsType":"staticOptions","placeholder":"-- SELECT --","showContent":false,"staticOptions":"[{\"key\":\"NO\",\"value\":\"No Adverse Effect\"},{\"key\":\"MILD\",\"value\":\"Mild Adverse Effect\"},{\"key\":\"SERIOUS\",\"value\":\"Serious Adverse Effect\"}]","requiredMessage":"Please select adverse effect from immunization","errorMsgListKeys":[],"additionalStaticOptionsRequired":"false"},"LMP (Last Menstrual Period) date":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"lmp_date","hasError":false,"showCard":true,"fieldName":"LMP (Last Menstrual Period) date","fieldType":"INFORMATION_DISPLAY","dateFormat":"dd/MM/yyyy","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"FIELD\",\"operator\":\"EQ\",\"value1\":\"''Female''\",\"value2\":null,\"fieldName\":\"$infoData$.memberData.gender\",\"queryCode\":null,\"expression\":null},{\"type\":\"VARIABLE\",\"operator\":\"GTE\",\"value1\":\"9\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null},{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"110\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"date","showContent":false,"displayValue":"LMP date","errorMsgListKeys":[]},"Last Method of Contraception Used":{"events":"null","ngModel":"$infoData$.memberData","fieldKey":"last_method_of_contraception","hasError":false,"showCard":true,"fieldName":"Last Method of Contraception Used","fieldType":"INFORMATION_DISPLAY","disability":"null","requirable":"null","visibility":"{\"conditions\":{\"rule\":\"AND\",\"options\":[{\"type\":\"VARIABLE\",\"operator\":\"GTE\",\"value1\":\"9\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null},{\"type\":\"VARIABLE\",\"operator\":\"LTE\",\"value1\":\"110\",\"value2\":null,\"fieldName\":\"$utilityData$.ageInYears\",\"queryCode\":null,\"expression\":null}]}}","displayType":"text","showContent":false,"displayValue":"Last Method of Contraception Used","errorMsgListKeys":[]}}}',
	'DRAFT',
	97104,
	now(),
	97104,
	now(),
	'[{"title":"$formData$","isArray":false,"nodes":[{"title":"memberVAEData","nodes":[],"indexAlias":null,"$$hashKey":"object:320","path":"$formData$.memberVAEData","backendConfigPath":"$formData$.memberVAEData"}],"path":"$formData$","backendConfigPath":"$formData$","$$hashKey":"object:291"},{"title":"$infoData$","isArray":false,"nodes":[{"title":"memberData","nodes":[],"indexAlias":null,"$$hashKey":"object:307","path":"$infoData$.memberData","backendConfigPath":"$infoData$.memberData"}],"path":"$infoData$","backendConfigPath":"$infoData$","$$hashKey":"object:292"}]',
	'label {
    white-space: normal !important;
    line-height: 1.2 !important;
}',
	'{"formVariables":[{"value":"ageInYears","type":"NUMBER","bindTo":"$utilityData$","setter":true,"setterMethodName":"setAgeInYears","setterMethodCode":"(function setAgeInYears() {\n\n    let ageParts = $infoData$.memberData.age.split('' '');\n    let years = 0;\n    if (ageParts.length < 6) {\n        years = 0\n    }\n    else {\n        years = isNaN(parseInt(ageParts[0])) ? 0 : parseInt(ageParts[0]);\n    }\n    $utilityData$.ageInYears = years;\n\t\n});"},{"value":"minServiceDate","type":"DATE","bindTo":"$utilityData$","setter":true,"setterMethodName":"setMinServiceDate","setterMethodCode":"(function setMinServiceDate() {\n    $utilityData$.minServiceDate = $formData$.memberVAEData.service_date ? moment($formData$.memberVAEData.service_date) : moment().subtract(9, ''months'');\n});"},{"value":"immunisationGiven","type":"ARRAY","bindTo":"$utilityData$","setter":true,"setterMethodName":"setImmunisationGiven","setterMethodCode":"(function setImmunisationGiven() {\n\tlet all_imm_given = $infoData$.memberData.immunisation_given.split('','');\n    let immunisations = [];\n    \n    for (let imm of all_imm_given) {\n        immunisations.push({key: imm.split(''#'')[0], value: imm.split(''#'')[0]});\n    }\n    console.log(immunisations)\n    $utilityData$.immunisationGiven = immunisations\n});"},{"value":"minExpiryDate","type":"DATE","bindTo":"$utilityData$","setter":true,"setterMethodName":"setMinExpiryDate","setterMethodCode":"(function setMinExpiryDate() {\n\t$utilityData$.minExpiryDate = $infoData$.memberData.dob;\n\t\n});"},{"value":"isChildImmunisedInOneYear","type":"BOOLEAN","bindTo":"$utilityData$","setter":true,"setterMethodName":"setIsChildImmunisedInOneYear","setterMethodCode":"(function setIsChildImmunisedInOneYear() {\n    const memberDetails = $infoData$.memberData\n        if (memberDetails.immunisation_given != null && memberDetails.immunisation_given.length > 0) {\n            const immunisationGiven = memberDetails.immunisation_given.split(\",\")\n            const immunisationList = []\n\n            for (let immunisation of immunisationGiven) {\n                immunisationList.push(immunisation.split(\"#\")[0])\n            }\n\n\n            if (immunisationList.length) {\n                if (\n                    immunisationList.includes(\"BCG\")\n                    && immunisationList.includes(\"OPV_1\")\n                    && immunisationList.includes(\"OPV_2\")\n                    && immunisationList.includes(\"OPV_3\")\n                    && (immunisationList.includes(\"PENTA_1\") || immunisationList.includes(\"DPT_1\"))\n                    && (immunisationList.includes(\"PENTA_2\") || immunisationList.includes(\"DPT_2\"))\n                    && (immunisationList.includes(\"PENTA_3\") || immunisationList.includes(\"DPT_3\"))\n                    && (immunisationList.includes(\"MEASLES_RUBELLA_1\") || immunisationList.includes(\"MEASLES_1\"))) {\n                    $utilityData$.isChildImmunisedInOneYear = true;\n                } else {\n                    $utilityData$.isChildImmunisedInOneYear = false;\n                }\n            } else {\n                $utilityData$.isChildImmunisedInOneYear = false;\n            }\n        } else {\n            $utilityData$.isChildImmunisedInOneYear = false;\n        }\n});"},{"value":"isChildImmunisedInTwoYear","type":"BOOLEAN","bindTo":"$utilityData$","setter":true,"setterMethodName":"setIsChildImmunisedInTwoYear","setterMethodCode":"(function setIsChildImmunisedInTwoYear() {\n    const memberDetails = $infoData$.memberData\n        if (memberDetails.immunisation_given != null && memberDetails.immunisation_given.length > 0) {\n            const immunisationGiven = memberDetails.immunisation_given.split(\",\")\n            const immunisationList = []\n\n            for (let immunisation of immunisationGiven) {\n                immunisationList.push(immunisation.split(\"#\")[0])\n            }\n\n            if (immunisationList.length) {\n                if (\n                    immunisationList.includes(\"BCG\")\n                    && immunisationList.includes(\"VITTAMIN_A_50000\")\n                    && immunisationList.includes(\"VITTAMIN_A_100000\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_1\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_2\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_3\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_4\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_5\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_6\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_7\")\n                    && immunisationList.includes(\"VITTAMIN_A_200000_8\")\n                    && immunisationList.includes(\"OPV_0\")\n                    && immunisationList.includes(\"OPV_1\")\n                    && immunisationList.includes(\"OPV_2\")\n                    && immunisationList.includes(\"OPV_3\")\n                    && immunisationList.includes(\"PCV_1\")\n                    && immunisationList.includes(\"PCV_2\")\n                    && immunisationList.includes(\"PCV_3\")\n                    && immunisationList.includes(\"DPT_HEB_HIB_1\")\n                    && immunisationList.includes(\"DPT_HEB_HIB_2\")\n                    && immunisationList.includes(\"DPT_HEB_HIB_3\")\n                    && immunisationList.includes(\"ROTA_VACCINE_1\")\n                    && immunisationList.includes(\"MEASLES_RUBELLA_1\")\n                    && immunisationList.includes(\"MEASLES_RUBELLA_2\")) {\n                    $utilityData$.isChildImmunisedInTwoYear = true;\n                } else {\n                    $utilityData$.isChildImmunisedInTwoYear = false;\n                }\n            } else {\n                $utilityData$.isChildImmunisedInTwoYear = false;\n            }\n        } else {\n            $utilityData$.isChildImmunisedInTwoYear = false;\n        }\n});"}],"formMethods":[{"value":"setImmunisationStatus","code":"(function setImmunisationStatus() {\n\tconst dobDate = new Date($infoData$.memberData.dob);\n    const currentDate = new Date();\n    \n    let age = currentDate.getFullYear() - dobDate.getFullYear();\n    const monthDiff = currentDate.getMonth() - dobDate.getMonth();\n    const dayDiff = currentDate.getDate() - dobDate.getDate();\n    \n    if (monthDiff < 0 || (monthDiff === 0 && dayDiff < 0)) {\n        age--;\n    }\n\n    if (age < 1) {\n        $infoData$.memberData.immunisation_status = ''Not fully immunised''\n    } else if (age >= 1 && age <= 2) {\n        $infoData$.memberData.immunisation_status = $utilityData$.isChildImmunisedInOneYear ? ''Fully immunised'' : ''Not fully immunised''\n    } else {\n        $infoData$.memberData.immunisation_status = $utilityData$.isChildImmunisedInTwoYear ? ''Fully immunised'' : ''Not fully immunised''\n    }\n});"}],"formQueries":[{"value":"Get Child Details","queryCode":"get_child_details","params":"member_id","paramConfig":"{\"member_id\":\"$formData$.memberVAEData.member_id\"}","query":"with\n    hof_det as (\n        select\n            im.mobile_number\n        from\n            imt_member im\n            where im.family_id = (select family_id from imt_member where id = #member_id#)\n            and im.family_head\n    )\nselect\n    im.unique_health_id,\n    concat_ws ('' '', im.first_name, im.middle_name, im.last_name) as member_name,\n    cast(age (im.dob) as text) as age,\n    im.dob,\n    case\n        when im.gender = ''F'' then ''Female''\n        else ''Male''\n    end as gender,\n    im.immunisation_given,\n    im.nrc_number,\n    im.weight,\n    im.birth_weight,\n    im.birth_cert_number,\n    (\n        select\n            value\n        from\n            listvalue_field_value_detail\n        where\n            id = im.marital_status\n    ) as marital_status,\n    (\n        select\n            value\n        from\n            listvalue_field_value_detail\n        where\n            cast(id as text) = case\n                when imf.religion is not null then imf.religion\n                when im.member_religion is not null then im.member_religion\n                else null\n            end\n    ) as religion,\n    case\n        when im.last_method_of_contraception = ''NATURAL_METHODS'' then ''Natural methods''\n        when im.last_method_of_contraception = ''ORALPILLS''\n        or im.last_method_of_contraception = ''ORAL_PILLS'' then ''Oral pills''\n        when im.last_method_of_contraception = ''IUCD5'' then ''IUCD 5 years''\n        when im.last_method_of_contraception = ''IUCD10'' then ''IUCD 10 years''\n        when im.last_method_of_contraception = ''STERILIZATION'' then ''Sterilization''\n        when im.last_method_of_contraception = ''CONDOM'' then ''Condom''\n        when im.last_method_of_contraception = ''MLSTR'' then ''Male sterilization''\n        when im.last_method_of_contraception = ''CONTRA'' then ''Emergency Contraceptive Pills''\n        when im.last_method_of_contraception = ''INJECTABLES'' then ''Injectables''\n        when im.last_method_of_contraception = ''BARRIER_METHOD'' then ''Barrier Method''\n        when im.last_method_of_contraception = ''CHHAYA'' then ''Chhaya''\n        when im.last_method_of_contraception = ''ANTARA'' then ''Antara''\n        else im.last_method_of_contraception\n    end as last_method_of_contraception,\n    im.lmp as lmp_date,\n    cast(im.additional_info as json)->> ''hivTest'' as hiv_status,\n    (\n        select\n            string_agg (value, '', '')\n        from\n            listvalue_field_value_detail lfvd\n        where\n            cast(id as text) in (\n                select\n                    unnest (string_to_array (im.chronic_disease, '',''))\n            )\n    ) as chronic_disease,\n    cast(im.additional_info as json)->> ''developmentalDelays'' as developmental_delay,\n    (\n        select\n            mobile_number\n        from\n            hof_det\n    ) as family_phone_no,\n    concat_ws ('' '', imf.house_number, imf.address1, imf.address2) as family_address\nfrom\n    imt_member im\n    inner join imt_family imf on imf.family_id = im.family_id\nwhere\n    im.id = #member_id#;","response":"$infoData$.memberData","isResultArray":null,"successMessage":null,"failureMessage":"Member not found.","isResponseMandatory":true,"isField":null,"isPagination":false},{"value":"Get Child VAE Data","queryCode":"get_child_vae_data","params":"member_vae_id","paramConfig":"{\"member_vae_id\":\"$stateParams$.id\"}","query":"select \n    id,\n    member_id,\n    adverse_effect,\n\tvaccine_name,\n\texpiry_date,\n\tbatch_number,\n\tmanufacturer\nfrom rch_vaccine_adverse_effect\nwhere id = #member_vae_id#\norder by modified_on desc limit 1;","response":"$formData$.memberVAEData","isResultArray":null,"successMessage":null,"failureMessage":"Screening records not found.","isResponseMandatory":true,"isField":null,"isPagination":false}]}',
	'[{"type":"FORM_QUERY","value":"Get Child VAE Data","continueIfFail":false},{"type":"FORM_QUERY","value":"Get Child Details","continueIfFail":false},{"type":"FORM_VARIABLE_SETTER","value":"isChildImmunisedInOneYear","continueIfFail":true},{"type":"FORM_VARIABLE_SETTER","value":"isChildImmunisedInTwoYear","continueIfFail":true},{"type":"FORM_METHOD","value":"setImmunisationStatus","continueIfFail":true},{"type":"FORM_VARIABLE_SETTER","value":"ageInYears","continueIfFail":true},{"type":"FORM_VARIABLE_SETTER","value":"minServiceDate","continueIfFail":true},{"type":"FORM_VARIABLE_SETTER","value":"immunisationGiven","continueIfFail":true},{"type":"FORM_VARIABLE_SETTER","value":"minExpiryDate","continueIfFail":true}]',
	'[{"queryCode":"update_vae_det","hasLoop":null,"queryPath":"$formData$.memberVAEData","subQueries":[],"params":[{"key":"adverse_effect","type":"FIELD","valueKey":"adverse_effect"},{"key":"vaccine_name","type":"FIELD","valueKey":"vaccine_name"},{"key":"batch_number","type":"FIELD","valueKey":"batch_number"},{"key":"expiry_date","type":"FIELD","valueKey":"expiry_date"},{"key":"manufacturer","type":"FIELD","valueKey":"manufacturer"},{"key":"vae_details_id","type":"META_DATA","valueKey":"$formData$.memberVAEData.id"}],"isEventResource":null,"$$hashKey":"object:14609","queryName":"Update VAE Details","query":"with update_or_delete as (\n    update rch_vaccine_adverse_effect\n    set\n        modified_by = #loggedInUserId#,\n        modified_on = now(),\n        adverse_effect = #adverse_effect#,\n        vaccine_name = #vaccine_name#,\n        batch_number = #batch_number#,\n        expiry_date = #expiry_date#,\n        manufacturer = #manufacturer#\n    where\n        id = #vae_details_id#\n        and #adverse_effect# <> ''NO''\n    returning id\n),\ndeleted as (\n    delete from rch_vaccine_adverse_effect\n    where id = #vae_details_id#\n    and #adverse_effect# = ''NO''\n    returning id\n)\n\nselect id from update_or_delete\nunion all\nselect id from deleted;\n"}]'
ON CONFLICT (form_master_uuid, "version")
DO UPDATE
SET
	form_master_uuid=EXCLUDED.form_master_uuid,
	template_config=EXCLUDED.template_config, 
	field_config=EXCLUDED.field_config, 
	"version"=EXCLUDED."version", 
	created_by=EXCLUDED.created_by,
	created_on=EXCLUDED.created_on,
	modified_by=EXCLUDED.modified_by,
	modified_on=EXCLUDED.modified_on,
	form_object=EXCLUDED.form_object,
	template_css=EXCLUDED.template_css,
	form_vm=EXCLUDED.form_vm,
	execution_sequence=EXCLUDED.execution_sequence,
	query_config=EXCLUDED.query_config;
